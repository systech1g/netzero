import { loadState, dollars } from './shared.js';
let state=loadState(); const COLUMNS=["symbol","strategy","side","quantity","shortStrike","longStrike","openDate","closeDate","realized","note"];
function render(){ const thead=document.querySelector('#journal thead'); const tbody=document.querySelector('#journal tbody'); thead.innerHTML=`<tr>${COLUMNS.map(c=>`<th data-col="${c}">${c}</th>`).join('')}</tr>`; const q=(document.getElementById('search').value||"").toLowerCase(); const rows=(state.journal||[]).filter(j=>{ const hay=[j.symbol,j.strategy,j.note].map(v=>String(v||'').toLowerCase()).join(' '); return !q||hay.includes(q); }); tbody.innerHTML=rows.map(j=>`<tr><td>${j.symbol||''}</td><td>${j.strategy||''}</td><td>${j.side||''}</td><td>${j.quantity||''}</td><td>${j.shortStrike||''}</td><td>${j.longStrike||''}</td><td>${j.openDate||''}</td><td>${j.closeDate||''}</td><td>${dollars(j.realized||0)}</td><td>${j.note||''}</td></tr>`).join(''); }
render(); document.getElementById('btn-export').addEventListener('click', ()=>{ const rows=state.journal||[]; const csv=Papa.unparse(rows); const blob=new Blob([csv],{type:"text/csv"}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=`netzero_journal_${Date.now()}.csv`; a.click(); setTimeout(()=>URL.revokeObjectURL(url),1000); }); document.getElementById('search').addEventListener('input', render);
